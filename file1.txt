this is modifyinf the algorithm from the existing one